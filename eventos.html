<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Raven's List - Eventos</title>
    <link rel="stylesheet" href="style.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* Estilos iniciais para esconder botões de logout e de CRUD (Serão alterados pelo JS) */
        .logout { display: none; }
        .login, .signup { display: none; }

        /* Classe para forçar cursor de ponteiro nos cards */
        .event-card {
            cursor: pointer;
        }

        /* Classe para desativar o link do card quando for modo funcionário */
        .card-no-link {
            text-decoration: none;
            color: inherit;
        }
    </style>
</head>
<body>

    <header class="navbar">
        <div class="logo-container">
            <a href="index.html" title="Ir para a página inicial">
                <img src="images/ravens_list.png" alt="The Raven's List Logo" class="logo-img"> 
            </a>
        </div>
        <nav class="nav-links">
            <a href="index.html" class="nav-item">Início</a>
            <a href="#" class="nav-item">Comunidade</a>
            <a href="https://moi-meme-moitie.com/" class="nav-item" target="_blank">Roupas</a>
            <a href="#" class="nav-item">Contate-nos</a>

            <a href="login.html" class="btn login">Login</a>
            <a href="cadastro.html" class="btn signup">Cadastre-se</a>
            
            <button class="btn logout" id="logoutBtn">Sair da Conta</button>
        </nav>
    </header>

    <main>
        
        <section class="events-controls">
            <div class="search-container">
                <input type="text" id="eventSearch" placeholder="Pesquisar" class="search-input">
            </div>
            
            <div class="filter-container">
                <label class="filter-checkbox">
                    <input type="checkbox" id="newEvents">
                    Novos eventos
                </label>
                <select id="eventsToSee" class="filter-select">
                    <option value="all">Eventos por ver</option>
                    <option value="today">Hoje</option>
                    <option value="week">Esta semana</option>
                </select>
            </div>
        </section>


        <div class="events-intro">
            <p class="intro-text">Sua plataforma para divulgação e venda de ingressos para seus eventos</p>
            <p class="intro-subtitle">Principais eventos:</p>
        </div>

        <section class="events-list">
            
            <div class="event-card" id="bioDementiaCard" data-event-name="Bio Dementia" data-ticket-price="25" data-capacity="400" data-link="https://www.sympla.com.br/evento/bio-dementia/2046255">
                <a href="https://www.sympla.com.br/evento/bio-dementia/2046255" target="_blank" class="event-link-wrapper" id="bioDementiaLink">
                    <div class="event-image-container">
                        <img src="images/bloodrock.jpg" alt="Capa Bio Dementia" class="card-cover-image">
                    </div>
                    
                    <div class="event-details-content">
                        <h2 class="event-title">Bio Dementia</h2>
                        <div class="event-icon-info">
                            <div class="event-icon">
                            <img src="images/bloodrock.jpg" alt="Capa Bio Dementia" class="card-cover-image">
                            </div>
                            <p class="event-venue">Bloodrock Bar</p>
                        </div>
                        <p class="event-description">Description</p>
                    </div>
                </a>
            </div>

            <div class="event-card" id="vampiresNightCard" data-event-name="Vampire's Night" data-ticket-price="50" data-capacity="700" data-link="#">
                <a href="#" class="event-link-wrapper" id="vampiresNightLink">
                    <div class="event-image-container">
                        <img src="images/vampires_night_cover.jpg" alt="Capa Vampire's Night" class="card-cover-image">
                    </div>
                    
                    <div class="event-details-content">
                        <h2 class="event-title">Vampire's Night</h2>
                        <div class="event-icon-info">
                            <div class="event-icon">
                                <img src="images/tork_icon.png" alt="Tork n' Roll Icon" class="icon-img">
                            </div>
                            <p class="event-venue">Tork n' Roll</p>
                        </div>
                        <p class="event-description">Description</p>
                    </div>
                </a>
            </div>

            <div class="event-card" id="noirFestCard" data-event-name="Noir Fest" data-ticket-price="75" data-capacity="1200" data-link="#">
                <a href="#" class="event-link-wrapper" id="noirFestLink">
                    <div class="event-image-container">
                        <img src="images/noir_fest_cover.jpg" alt="Capa Noir Fest" class="card-cover-image">
                    </div>
                    
                    <div class="event-details-content">
                        <h2 class="event-title">Noir Fest</h2>
                        <div class="event-icon-info">
                            <div class="event-icon">
                                <img src="images/jokerspub_icon.png" alt="Jokers Pub Icon" class="icon-img">
                            </div>
                            <p class="event-venue">Jokers Pub</p>
                        </div>
                        <p class="event-description">Description</p>
                    </div>
                </a>
            </div>
            
        </section>
    </main>

    <div id="funcionarioModal" class="modal-overlay">
        <div class="modal-content" style="background-color: var(--color-red-card);">
            <span class="close-btn" id="closeModalBtn">&times;</span>
            <h2 class="modal-title">Ações do Evento: <span id="modalEventTitle"></span></h2>
            
            <div class="modal-buttons">
                <a href="#" class="btn modal-btn" id="dashboardBtn">Acessar Dashboard</a>
                <a href="#" class="btn modal-btn" id="crud1Btn">CRUD de Eventos</a>
                <a href="#" class="btn modal-btn" id="crud2Btn">CRUD de Ingressos</a>
            </div>
            
            <p class="modal-action-hint">Esta área é exclusiva para funcionários.</p>
        </div>
    </div>

    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-section contact-links">
                <div class="logo-container">
                    <a href="index.html" title="Ir para a página inicial">
                        <img src="images/ravens_list.png" alt="The Raven's List Logo" class="logo-img"> 
                    </a>
                </div>
                <div class="social-links">
                    <a href="#" aria-label="X (Twitter)"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>

            <div class="footer-section">
                <h3 class="footer-title">Contato</h3>
                <ul class="footer-links">
                    <li><a href="https://github.com/Rhuuuyyyy">Trabalhe conosco</a></li>
                    <li><a href="https://github.com/AugustoNeon">Parcerias</a></li>
                    <li><a href="eventos.html">Eventos</a></li>
                    <li><a href="#">Loja de Roupa</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script>
        // --- 0. Lógica de Validação e Variáveis de Estado ---
        
        // Lê o estado do LocalStorage
        const storedLogin = localStorage.getItem('isLoggedIn') === 'true';
        const storedUserType = localStorage.getItem('userType');
        
        // Define as variáveis de estado com base no LocalStorage
        const isLoggedIn = storedLogin;
        const isFuncionario = storedLogin && storedUserType === 'funcionario'; 
        
        // Dados Simulados dos Eventos
        const eventData = {
            'Bio Dementia': {
                sales: 380,
                price: 25,
                capacity: 400,
                link: 'https://www.sympla.com.br/evento/bio-dementia/2046255'
            },
            "Vampire's Night": {
                sales: 550,
                price: 50,
                capacity: 700,
                link: 'https://seulink.com.br/vampires-night'
            },
            'Noir Fest': {
                sales: 900,
                price: 75,
                capacity: 1200,
                link: 'https://seulink.com.br/noir-fest'
            }
        };

        const loginBtn = document.querySelector('.login');
        const signupBtn = document.querySelector('.signup');
        const logoutBtn = document.querySelector('.logout');
        const modal = document.getElementById('funcionarioModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const modalEventTitle = document.getElementById('modalEventTitle');
        const dashboardBtn = document.getElementById('dashboardBtn');
        
        // --- 1. Lógica da Navbar ---
        if (isLoggedIn) {
            // Se logado: Esconde Login/Cadastro, mostra Sair
            loginBtn.style.display = 'none';
            signupBtn.style.display = 'none';
            logoutBtn.style.display = 'inline-block';
        } else {
            // Se não logado: Mostra Login/Cadastro, esconde Sair
            loginBtn.style.display = 'inline-block';
            signupBtn.style.display = 'inline-block';
            logoutBtn.style.display = 'none';
        }
        
        // Lógica de Logout: Limpa o LocalStorage
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('userType');
            alert('Você foi desconectado. Redirecionando para a página inicial...');
            window.location.href = 'index.html'; 
        });

        // --- 2. Lógica dos Cards (Funcionalidade de Modal ou Link) ---

        const eventCards = document.querySelectorAll('.event-card');

        eventCards.forEach(card => {
            const eventName = card.getAttribute('data-event-name');
            const data = eventData[eventName];
            const eventLinkWrapper = card.querySelector('.event-link-wrapper');

            if (!data) return;

            if (isFuncionario) {
                // SE FUNCIONÁRIO: Abre Modal
                eventLinkWrapper.href = '#';
                eventLinkWrapper.classList.add('card-no-link');
                
                eventLinkWrapper.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    // Configura o modal com os dados específicos
                    modalEventTitle.textContent = eventName;
                    
                    const arrecadado = (data.sales * data.price).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
                    const ocupacao = ((data.sales / data.capacity) * 100).toFixed(1);
                    
                    dashboardBtn.textContent = `Acessar Dashboard (${data.sales} vendas, ${arrecadado} Arrecadados, ${ocupacao}% lotado)`;
                    
                    modal.style.display = 'block';
                });
                
            } else {
                // SE CLIENTE OU NÃO LOGADO: Link Externo (Sympla ou outro)
                eventLinkWrapper.href = data.link;
                eventLinkWrapper.target = '_blank';
            }
        });
        
        // --- 3. Lógica do Modal (MANTIDA) ---
        
        // Fechar modal pelo botão X
        closeModalBtn.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        // Fechar modal clicando fora
        window.addEventListener('click', (event) => {
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        });
        
        // Lógica de simulação de CRUDs (Apenas alerta para feedback)
        document.getElementById('crud1Btn').addEventListener('click', () => {
            const eventName = modalEventTitle.textContent;
            alert(`Abrindo CRUD de Eventos para: ${eventName}...`);
        });
        document.getElementById('crud2Btn').addEventListener('click', () => {
            const eventName = modalEventTitle.textContent;
            alert(`Abrindo CRUD de Ingressos para: ${eventName}...`);
        });
        
    </script>
    <script src="login.js"></script> 
</body>
</html>